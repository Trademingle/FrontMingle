{"ast":null,"code":"var _jsxFileName = \"/Users/nandupokhrel/Desktop/BookTrades/trademingle/src/components/Login/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { Component, useState } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { signin } from '../Firebase/auth';\nimport Popup from 'reactjs-popup';\nimport { withStyles } from '@material-ui/core/styles';\nimport SignUpPage from '../SignUp/index.js';\nimport * as ROUTES from '../../constants/routes';\nimport Button from '@material-ui/core/Button';\nimport { compose } from 'recompose';\nimport { withFirebase } from '../Firebase';\nimport styles from './login.module.css';\nimport CloseOutlinedIcon from '@material-ui/icons/CloseOutlined'; // import SignUpWithEmail from \"../SignUp/SignUpWithEmail/SUemail\";\n\nimport glogo from \"../SignUp/icons/google-icon.svg\"; // import elogo from '../SignUp/icons/email1.svg';\n\nimport alogo from \"../SignUp/icons/apple.svg\";\nimport api from '../api/api';\nimport { purple } from '@material-ui/core/colors';\nimport Firebase from '../Firebase/firebase';\nimport swal from 'sweetalert';\nimport LoadingView from '../ResuableComponents/loadingView';\nconst contentStyle2 = {\n  width: '702px',\n  height: '680px',\n  background: '#FFFFFF',\n  borderRadius: '16px'\n};\n\nconst SignIn = props => {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const [open1, setOpen1] = useState(false);\n\n  const signInCallback = val => {\n    setLoading(false);\n\n    if (val['usertype'] === 'Contractor') {\n      window.location.href = '/contractorexplore';\n    } else if (val['usertype'] === 'Client') {\n      window.location.href = '/homeownerexplore';\n    } else {\n      swal({\n        title: \"Login Error!\",\n        text: \"Login error! Please make sure you have signed up!\",\n        icon: \"error\",\n        button: \"Try Again\"\n      });\n    }\n  };\n\n  const onSignIn = () => {\n    setLoading(true);\n    Firebase.auth.currentUser.getIdToken(\n    /* forceRefresh */\n    true).then(function (idToken) {\n      // Send token to your backend via HTTPS\n      // ...\n      // informationState['id_token'] = idToken;\n      api.signIn({\n        'id_token': idToken\n      }, signInCallback);\n    }).catch(function (error) {\n      // Handle error\n      // setStateCode(9);\n      setLoading(false);\n      console.log(error);\n    });\n  };\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(LoadingView, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 12\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Popup, {\n    open: props.open,\n    modal: true,\n    contentStyle: contentStyle2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"box\", {\n    className: styles.box,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CloseOutlinedIcon, {\n    style: {\n      height: 40,\n      width: 40\n    },\n    className: styles.cross,\n    onClick: () => props.setOpen(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"h1\", {\n    className: styles.header,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }, \"Log in\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.para,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }, \"Whether you're a contractor, homeowner or homebuilder, log in here!\"), /*#__PURE__*/React.createElement(\"box\", {\n    className: styles.rectangle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(SignInGoogle, {\n    signIn: onSignIn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: styles.apple,\n    onClick: () => swal({\n      title: \"Feature Unavailable!\",\n      text: \"Please sign up with google or create an account!\",\n      icon: \"error\",\n      button: \"Go back!\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: alogo,\n    className: styles.logo,\n    alt: 'apple',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    ClassName: styles.signupapple,\n    style: {\n      marginTop: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }, \"Log in with Apple\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.linesdiv,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"hr\", {\n    className: styles.line1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.or,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, \"OR\"), /*#__PURE__*/React.createElement(\"hr\", {\n    className: styles.line1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Login, {\n    setLoading: setLoading,\n    setOpen1: setOpen1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }))), /*#__PURE__*/React.createElement(SignUpPage, {\n    setOpen: setOpen1,\n    open: open1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }\n  }));\n};\n\n_s(SignIn, \"Evh1mqV1r2gxN5oCabWDo+bWJhU=\");\n\n_c = SignIn;\n\nclass SignInGoogleBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onSubmit = event => {\n      this.props.firebase.doSignInWithGoogle().then(socialAuthUser => {\n        // debugger;\n        // this.props.firebase\n        //   .user(socialAuthUser.user.uid)\n        //   .set({\n        //     username: socialAuthUser.user.displayName,\n        //     email: socialAuthUser.user.email,\n        //     roles: {},\n        //   });\n        // debugger;\n        this.props.signIn();\n      }).then(() => {\n        this.setState({\n          error: null\n        });\n        this.props.history.push(ROUTES.LANDING);\n      }).catch(error => {\n        this.setState({\n          error\n        });\n      });\n      event.preventDefault();\n    };\n\n    this.state = {\n      error: null\n    };\n  }\n\n  render() {\n    const {\n      error\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: styles.apple,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: glogo,\n      className: styles.logo,\n      alt: 'google',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      ClassName: styles.signupapple,\n      style: {\n        marginTop: '20px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 15\n      }\n    }, \"Log in with Google\")), error && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 19\n      }\n    }, error.message));\n  }\n\n}\n\nconst SignInGoogle = compose(withRouter, withFirebase)(SignInGoogleBase);\n\nclass Login extends Component {\n  constructor() {\n    super();\n    this.state = {\n      error: null,\n      email: '',\n      password: ''\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.loginClicked = this.loginClicked.bind(this);\n  }\n\n  signInCallback(val) {\n    // console.log(val);\n    if (val['usertype'] === 'Contractor') {\n      window.location.href = '/contractorexplore';\n    } else if (val['usertype'] === 'Client') {\n      window.location.href = '/homeownerexplore';\n    } else {\n      swal({\n        title: \"Login Error!\",\n        text: \"Incorrect username or password!\",\n        icon: \"error\",\n        button: \"Try Again\"\n      });\n    }\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  loginClicked(event) {\n    this.props.setLoading(true);\n    const callBack = this.signInCallback;\n\n    if (this.state.email && this.state.password) {\n      Firebase.auth.signInWithEmailAndPassword(this.state.email, this.state.password).then(userCredential => {\n        userCredential.user.getIdToken(\n        /* forceRefresh */\n        true).then(function (idToken) {\n          // Signed in\n          api.signIn({\n            'id_token': idToken\n          }, callBack);\n          this.props.setLoading(false);\n        });\n      }).catch(error => {\n        var errorCode = error.code;\n        var errorMessage = error.message; //Still have to sign in with the django backend\n\n        const info = {\n          \"username\": this.state.email,\n          \"password\": this.state.password\n        };\n        api.signIn(info, this.signInCallback);\n        this.props.setLoading(false); // ...\n      });\n    }\n  }\n\n  async handleSubmit(event) {\n    event.preventDefault();\n    this.setState({\n      error: ''\n    });\n\n    try {\n      await signin(this.state.email, this.state.password);\n    } catch (error) {// this.setState({ error: error.message });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loginContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      autoComplete: \"off\",\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: styles.password,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }\n    }, \"Email\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.rectangle1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: styles.input1,\n      placeholder: \"Enter your email address\",\n      name: \"email\",\n      type: \"email\",\n      onChange: this.handleChange,\n      value: this.state.email,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"h3\", {\n      className: styles.password,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }\n    }, \"Password\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.rectangle1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: styles.input1,\n      placeholder: \"Password\",\n      name: \"password\",\n      onChange: this.handleChange,\n      value: this.state.password,\n      type: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loginbuttondiv,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 11\n      }\n    }, this.state.error ? /*#__PURE__*/React.createElement(\"p\", {\n      className: \"text-danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 33\n      }\n    }, this.state.error) : null, /*#__PURE__*/React.createElement(LoginButton, {\n      type: \"submit\",\n      className: styles.loginbutton,\n      onClick: this.loginClicked,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: styles.login,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 15\n      }\n    }, \"Log in \"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.textdiv,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: styles.text2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 13\n      }\n    }, \"Don't have an account?\"), /*#__PURE__*/React.createElement(\"p\", {\n      className: styles.signup,\n      onClick: () => this.props.setOpen1(true),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 13\n      }\n    }, \" Sign up\"))));\n  }\n\n}\n\nconst LoginButton = withStyles(theme => ({\n  root: {\n    color: theme.palette.getContrastText(purple[500]),\n    borderRadius: 44,\n    backgroundColor: '#2B64D2',\n    '&:hover': {\n      backgroundColor: '#003ba0'\n    }\n  }\n}))(Button);\nexport default SignIn;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignIn\");","map":{"version":3,"sources":["/Users/nandupokhrel/Desktop/BookTrades/trademingle/src/components/Login/index.js"],"names":["React","Component","useState","withRouter","signin","Popup","withStyles","SignUpPage","ROUTES","Button","compose","withFirebase","styles","CloseOutlinedIcon","api","purple","Firebase","swal","LoadingView","contentStyle2","width","height","background","borderRadius","SignIn","props","loading","setLoading","open1","setOpen1","signInCallback","val","window","location","href","title","text","icon","button","onSignIn","auth","currentUser","getIdToken","then","idToken","signIn","catch","error","console","log","open","box","cross","setOpen","header","para","rectangle","apple","alogo","logo","signupapple","marginTop","linesdiv","line1","or","SignInGoogleBase","constructor","onSubmit","event","firebase","doSignInWithGoogle","socialAuthUser","setState","history","push","LANDING","preventDefault","state","render","glogo","message","SignInGoogle","Login","email","password","handleChange","bind","handleSubmit","loginClicked","target","name","value","callBack","signInWithEmailAndPassword","userCredential","user","errorCode","code","errorMessage","info","loginContainer","rectangle1","input1","loginbuttondiv","loginbutton","login","textdiv","text2","signup","LoginButton","theme","root","color","palette","getContrastText","backgroundColor"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAAQC,MAAR,QAAqB,kBAArB;AACA,OAAOC,KAAP,MAAkB,eAAlB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,UAAP,MAAuB,oBAAvB;AACA,OAAO,KAAKC,MAAZ,MAAwB,wBAAxB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,SAASC,OAAT,QAAwB,WAAxB;AACA,SAASC,YAAT,QAA6B,aAA7B;AACA,OAAOC,MAAP,MAAmB,oBAAnB;AACA,OAAOC,iBAAP,MAA8B,kCAA9B,C,CACA;;qDAEA;;;AAEA,OAAOC,GAAP,MAAiB,YAAjB;AACA,SAASC,MAAT,QAAuB,0BAAvB;AACA,OAAOC,QAAP,MAAqB,sBAArB;AACA,OAAOC,IAAP,MAAiB,YAAjB;AACA,OAAOC,WAAP,MAAwB,mCAAxB;AAEA,MAAMC,aAAa,GAAG;AACpBC,EAAAA,KAAK,EAAE,OADa;AAEpBC,EAAAA,MAAM,EAAE,OAFY;AAGpBC,EAAAA,UAAU,EAAE,SAHQ;AAIpBC,EAAAA,YAAY,EAAE;AAJM,CAAtB;;AAOA,MAAMC,MAAM,GAAIC,KAAD,IAAW;AAAA;;AACxB,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBzB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAAC0B,KAAD,EAAQC,QAAR,IAAoB3B,QAAQ,CAAC,KAAD,CAAlC;;AACA,QAAM4B,cAAc,GAAGC,GAAD,IAAO;AAC3BJ,IAAAA,UAAU,CAAC,KAAD,CAAV;;AACA,QAAII,GAAG,CAAC,UAAD,CAAH,KAAoB,YAAxB,EAAqC;AACnCC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAqB,oBAArB;AACD,KAFD,MAGK,IAAIH,GAAG,CAAC,UAAD,CAAH,KAAoB,QAAxB,EAAiC;AACpCC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAqB,mBAArB;AACD,KAFI,MAGD;AACFjB,MAAAA,IAAI,CAAC;AACHkB,QAAAA,KAAK,EAAE,cADJ;AAEHC,QAAAA,IAAI,EAAE,mDAFH;AAGHC,QAAAA,IAAI,EAAE,OAHH;AAIHC,QAAAA,MAAM,EAAE;AAJL,OAAD,CAAJ;AAMD;AACF,GAhBD;;AAiBA,QAAMC,QAAQ,GAAE,MAAI;AAClBZ,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAX,IAAAA,QAAQ,CAACwB,IAAT,CAAcC,WAAd,CAA0BC,UAA1B;AAAqC;AAAmB,QAAxD,EAA8DC,IAA9D,CAAmE,UAASC,OAAT,EAAkB;AACnF;AACA;AACA;AACA9B,MAAAA,GAAG,CAAC+B,MAAJ,CAAW;AAAC,oBAAWD;AAAZ,OAAX,EAAgCd,cAAhC;AACD,KALD,EAKGgB,KALH,CAKS,UAASC,KAAT,EAAgB;AACvB;AACA;AACApB,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAqB,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD,KAVD;AAYD,GAdD;;AAeA,MAAIrB,OAAJ,EAAa;AACX,wBAAO,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACD;;AACD,sBACE,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAED,KAAK,CAACyB,IAAnB;AAAyB,IAAA,KAAK,MAA9B;AAA+B,IAAA,YAAY,EAAE/B,aAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAK,IAAA,SAAS,EAAEP,MAAM,CAACuC,GAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,iBAAD;AAAmB,IAAA,KAAK,EAAE;AAAE9B,MAAAA,MAAM,EAAE,EAAV;AAAcD,MAAAA,KAAK,EAAE;AAArB,KAA1B;AAAqD,IAAA,SAAS,EAAER,MAAM,CAACwC,KAAvE;AAA8E,IAAA,OAAO,EAAE,MAAI3B,KAAK,CAAC4B,OAAN,CAAc,KAAd,CAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE;AAAI,IAAA,SAAS,EAAEzC,MAAM,CAAC0C,MAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE;AAAG,IAAA,SAAS,EAAE1C,MAAM,CAAC2C,IAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2EAHF,eAIE;AAAK,IAAA,SAAS,EAAE3C,MAAM,CAAC4C,SAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAc,IAAA,MAAM,EAAEjB,QAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eAIE;AACE,IAAA,SAAS,EAAE3B,MAAM,CAAC6C,KADpB;AAEE,IAAA,OAAO,EAAE,MACPxC,IAAI,CAAC;AACHkB,MAAAA,KAAK,EAAE,sBADJ;AAEHC,MAAAA,IAAI,EAAE,kDAFH;AAGHC,MAAAA,IAAI,EAAE,OAHH;AAIHC,MAAAA,MAAM,EAAE;AAJL,KAAD,CAHR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBASI;AAAK,IAAA,GAAG,EAAEoB,KAAV;AAAiB,IAAA,SAAS,EAAE9C,MAAM,CAAC+C,IAAnC;AAAwC,IAAA,GAAG,EAAE,OAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATJ,eAUI;AAAG,IAAA,SAAS,EAAE/C,MAAM,CAACgD,WAArB;AAAkC,IAAA,KAAK,EAAE;AAACC,MAAAA,SAAS,EAAC;AAAX,KAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAVJ,CAJF,eAgBE;AAAK,IAAA,SAAS,EAAEjD,MAAM,CAACkD,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAElD,MAAM,CAACmD,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE;AAAG,IAAA,SAAS,EAAEnD,MAAM,CAACoD,EAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAFF,eAGE;AAAI,IAAA,SAAS,EAAEpD,MAAM,CAACmD,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,CAhBF,eAqBE,oBAAC,KAAD;AAAO,IAAA,UAAU,EAAEpC,UAAnB;AAA+B,IAAA,QAAQ,EAAEE,QAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IArBF,CAJF,CADA,eA6BA,oBAAC,UAAD;AAAY,IAAA,OAAO,EAAEA,QAArB;AAA+B,IAAA,IAAI,EAAED,KAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7BA,CADF;AAiCD,CAvED;;GAAMJ,M;;KAAAA,M;;AAwEN,MAAMyC,gBAAN,SAA+BhE,SAA/B,CAAyC;AACvCiE,EAAAA,WAAW,CAACzC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAMnB0C,QANmB,GAMRC,KAAK,IAAI;AAClB,WAAK3C,KAAL,CAAW4C,QAAX,CACGC,kBADH,GAEG3B,IAFH,CAEQ4B,cAAc,IAAI;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK9C,KAAL,CAAWoB,MAAX;AACD,OAbH,EAcGF,IAdH,CAcQ,MAAM;AACV,aAAK6B,QAAL,CAAc;AAAEzB,UAAAA,KAAK,EAAE;AAAT,SAAd;AACA,aAAKtB,KAAL,CAAWgD,OAAX,CAAmBC,IAAnB,CAAwBlE,MAAM,CAACmE,OAA/B;AACD,OAjBH,EAkBG7B,KAlBH,CAkBSC,KAAK,IAAI;AACd,aAAKyB,QAAL,CAAc;AAAEzB,UAAAA;AAAF,SAAd;AACD,OApBH;AAsBAqB,MAAAA,KAAK,CAACQ,cAAN;AACD,KA9BkB;;AAGjB,SAAKC,KAAL,GAAa;AAAE9B,MAAAA,KAAK,EAAE;AAAT,KAAb;AACD;;AA4BD+B,EAAAA,MAAM,GAAG;AACP,UAAM;AAAE/B,MAAAA;AAAF,QAAY,KAAK8B,KAAvB;AAEA,wBACE;AAAM,MAAA,QAAQ,EAAE,KAAKV,QAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EAAEvD,MAAM,CAAC6C,KADpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEI;AAAK,MAAA,GAAG,EAAEsB,KAAV;AAAiB,MAAA,SAAS,EAAEnE,MAAM,CAAC+C,IAAnC;AAAyC,MAAA,GAAG,EAAE,QAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,eAGM;AAAG,MAAA,SAAS,EAAE/C,MAAM,CAACgD,WAArB;AAAkC,MAAA,KAAK,EAAE;AAACC,QAAAA,SAAS,EAAC;AAAX,OAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAHN,CADF,EAOGd,KAAK,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAIA,KAAK,CAACiC,OAAV,CAPZ,CADF;AAWD;;AA/CsC;;AAiDzC,MAAMC,YAAY,GAAGvE,OAAO,CAC1BP,UAD0B,EAE1BQ,YAF0B,CAAP,CAGnBsD,gBAHmB,CAArB;;AAKA,MAAMiB,KAAN,SAAoBjF,SAApB,CAA8B;AAE5BiE,EAAAA,WAAW,GAAG;AACZ;AACA,SAAKW,KAAL,GAAa;AACX9B,MAAAA,KAAK,EAAE,IADI;AAEXoC,MAAAA,KAAK,EAAE,EAFI;AAGXC,MAAAA,QAAQ,EAAE;AAHC,KAAb;AAKA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKE,YAAL,GAAoB,KAAKA,YAAL,CAAkBF,IAAlB,CAAuB,IAAvB,CAApB;AACD;;AAEDxD,EAAAA,cAAc,CAACC,GAAD,EAAK;AACjB;AACA,QAAIA,GAAG,CAAC,UAAD,CAAH,KAAoB,YAAxB,EAAqC;AACnCC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAqB,oBAArB;AACD,KAFD,MAGK,IAAIH,GAAG,CAAC,UAAD,CAAH,KAAoB,QAAxB,EAAiC;AACpCC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAqB,mBAArB;AACD,KAFI,MAGD;AACFjB,MAAAA,IAAI,CAAC;AACHkB,QAAAA,KAAK,EAAE,cADJ;AAEHC,QAAAA,IAAI,EAAE,iCAFH;AAGHC,QAAAA,IAAI,EAAE,OAHH;AAIHC,QAAAA,MAAM,EAAE;AAJL,OAAD,CAAJ;AAMD;AACF;;AACD+C,EAAAA,YAAY,CAACjB,KAAD,EAAQ;AAClB,SAAKI,QAAL,CAAc;AACZ,OAACJ,KAAK,CAACqB,MAAN,CAAaC,IAAd,GAAqBtB,KAAK,CAACqB,MAAN,CAAaE;AADtB,KAAd;AAGD;;AACDH,EAAAA,YAAY,CAACpB,KAAD,EAAO;AACjB,SAAK3C,KAAL,CAAWE,UAAX,CAAsB,IAAtB;AACA,UAAMiE,QAAQ,GAAG,KAAK9D,cAAtB;;AACA,QAAI,KAAK+C,KAAL,CAAWM,KAAX,IAAoB,KAAKN,KAAL,CAAWO,QAAnC,EAA4C;AAC1CpE,MAAAA,QAAQ,CAACwB,IAAT,CAAcqD,0BAAd,CAAyC,KAAKhB,KAAL,CAAWM,KAApD,EAA2D,KAAKN,KAAL,CAAWO,QAAtE,EACCzC,IADD,CACOmD,cAAD,IAAoB;AACxBA,QAAAA,cAAc,CAACC,IAAf,CAAoBrD,UAApB;AAA+B;AAAmB,YAAlD,EAAwDC,IAAxD,CAA6D,UAASC,OAAT,EAAkB;AAC7E;AACA9B,UAAAA,GAAG,CAAC+B,MAAJ,CAAW;AAAC,wBAAWD;AAAZ,WAAX,EAAgCgD,QAAhC;AACE,eAAKnE,KAAL,CAAWE,UAAX,CAAsB,KAAtB;AACH,SAJD;AAMD,OARD,EASCmB,KATD,CASQC,KAAD,IAAW;AAChB,YAAIiD,SAAS,GAAGjD,KAAK,CAACkD,IAAtB;AACA,YAAIC,YAAY,GAAGnD,KAAK,CAACiC,OAAzB,CAFgB,CAGhB;;AACA,cAAMmB,IAAI,GAAG;AACX,sBAAY,KAAKtB,KAAL,CAAWM,KADZ;AAEX,sBAAY,KAAKN,KAAL,CAAWO;AAFZ,SAAb;AAIAtE,QAAAA,GAAG,CAAC+B,MAAJ,CAAWsD,IAAX,EAAgB,KAAKrE,cAArB;AACA,aAAKL,KAAL,CAAWE,UAAX,CAAsB,KAAtB,EATgB,CAUhB;AACD,OApBD;AAsBD;AACF;;AAEiB,QAAZ4D,YAAY,CAACnB,KAAD,EAAQ;AACxBA,IAAAA,KAAK,CAACQ,cAAN;AACA,SAAKJ,QAAL,CAAc;AAAEzB,MAAAA,KAAK,EAAE;AAAT,KAAd;;AACA,QAAI;AACF,YAAM3C,MAAM,CAAC,KAAKyE,KAAL,CAAWM,KAAZ,EAAmB,KAAKN,KAAL,CAAWO,QAA9B,CAAZ;AACD,KAFD,CAEE,OAAOrC,KAAP,EAAc,CACd;AACD;AACF;;AACD+B,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAElE,MAAM,CAACwF,cAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAM,MAAA,YAAY,EAAC,KAAnB;AAAyB,MAAA,QAAQ,EAAE,KAAKb,YAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAI,MAAA,SAAS,EAAE3E,MAAM,CAACwE,QAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE;AAAK,MAAA,SAAS,EAAExE,MAAM,CAACyF,UAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAO,MAAA,SAAS,EAAEzF,MAAM,CAAC0F,MAAzB;AAAiC,MAAA,WAAW,EAAC,0BAA7C;AAAwE,MAAA,IAAI,EAAC,OAA7E;AAAqF,MAAA,IAAI,EAAC,OAA1F;AAAkG,MAAA,QAAQ,EAAE,KAAKjB,YAAjH;AAA+H,MAAA,KAAK,EAAE,KAAKR,KAAL,CAAWM,KAAjJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFF,eAKE;AAAI,MAAA,SAAS,EAAEvE,MAAM,CAACwE,QAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,eAME;AAAK,MAAA,SAAS,EAAExE,MAAM,CAACyF,UAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAO,MAAA,SAAS,EAAEzF,MAAM,CAAC0F,MAAzB;AAAiC,MAAA,WAAW,EAAC,UAA7C;AAAwD,MAAA,IAAI,EAAC,UAA7D;AAAwE,MAAA,QAAQ,EAAE,KAAKjB,YAAvF;AAAqG,MAAA,KAAK,EAAE,KAAKR,KAAL,CAAWO,QAAvH;AAAiI,MAAA,IAAI,EAAC,UAAtI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CANF,eASE;AAAK,MAAA,SAAS,EAAExE,MAAM,CAAC2F,cAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAK1B,KAAL,CAAW9B,KAAX,gBAAmB;AAAG,MAAA,SAAS,EAAC,aAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA4B,KAAK8B,KAAL,CAAW9B,KAAvC,CAAnB,GAAuE,IAD1E,eAEE,oBAAC,WAAD;AAAa,MAAA,IAAI,EAAC,QAAlB;AAA2B,MAAA,SAAS,EAAEnC,MAAM,CAAC4F,WAA7C;AAA0D,MAAA,OAAO,EAAE,KAAKhB,YAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAG,MAAA,SAAS,EAAE5E,MAAM,CAAC6F,KAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,CAFF,CATF,eAeE;AAAK,MAAA,SAAS,EAAE7F,MAAM,CAAC8F,OAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAG,MAAA,SAAS,EAAE9F,MAAM,CAAC+F,KAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCADF,eAEE;AAAG,MAAA,SAAS,EAAE/F,MAAM,CAACgG,MAArB;AAA6B,MAAA,OAAO,EAAE,MAAI,KAAKnF,KAAL,CAAWI,QAAX,CAAoB,IAApB,CAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,CAfF,CADF,CADF;AAwBD;;AAnG2B;;AAsG9B,MAAMgF,WAAW,GAAGvG,UAAU,CAAEwG,KAAD,KAAY;AACzCC,EAAAA,IAAI,EAAE;AACJC,IAAAA,KAAK,EAAEF,KAAK,CAACG,OAAN,CAAcC,eAAd,CAA8BnG,MAAM,CAAC,GAAD,CAApC,CADH;AAEJQ,IAAAA,YAAY,EAAC,EAFT;AAGJ4F,IAAAA,eAAe,EAAE,SAHb;AAIJ,eAAW;AACTA,MAAAA,eAAe,EAAE;AADR;AAJP;AADmC,CAAZ,CAAD,CAAV,CAShB1G,MATgB,CAApB;AAWA,eAAee,MAAf","sourcesContent":["import React, { Component, useState } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport {signin} from '../Firebase/auth';\nimport Popup from 'reactjs-popup';\nimport { withStyles } from '@material-ui/core/styles';\nimport SignUpPage from '../SignUp/index.js';\nimport * as ROUTES from '../../constants/routes';\nimport Button from '@material-ui/core/Button';\nimport { compose } from 'recompose';\nimport { withFirebase } from '../Firebase';\nimport styles from './login.module.css';\nimport CloseOutlinedIcon from '@material-ui/icons/CloseOutlined';\n// import SignUpWithEmail from \"../SignUp/SignUpWithEmail/SUemail\";\nimport glogo from '../SignUp/icons/google-icon.svg';\n// import elogo from '../SignUp/icons/email1.svg';\nimport alogo from '../SignUp/icons/apple.svg';\nimport api  from '../api/api';\nimport { purple } from '@material-ui/core/colors'; \nimport Firebase from '../Firebase/firebase';\nimport swal from 'sweetalert';\nimport LoadingView from '../ResuableComponents/loadingView';\n\nconst contentStyle2 = {\n  width: '702px',\n  height: '680px',\n  background: '#FFFFFF',\n  borderRadius: '16px', \n};\n\nconst SignIn = (props) => {\n  const [loading, setLoading] = useState(false);\n  const [open1, setOpen1] = useState(false);\n  const signInCallback= (val)=>{\n    setLoading(false)\n    if (val['usertype'] === 'Contractor'){\n      window.location.href='/contractorexplore'\n    }\n    else if (val['usertype'] === 'Client'){\n      window.location.href='/homeownerexplore'\n    }\n    else{\n      swal({\n        title: \"Login Error!\",\n        text: \"Login error! Please make sure you have signed up!\",\n        icon: \"error\",\n        button: \"Try Again\",\n      });\n    }\n  }\n  const onSignIn= ()=>{\n    setLoading(true)\n    Firebase.auth.currentUser.getIdToken(/* forceRefresh */ true).then(function(idToken) {\n      // Send token to your backend via HTTPS\n      // ...\n      // informationState['id_token'] = idToken;\n      api.signIn({'id_token':idToken},signInCallback);\n    }).catch(function(error) {\n      // Handle error\n      // setStateCode(9);\n      setLoading(false)\n      console.log(error)\n    }\n    );\n  }\n  if (loading) {\n    return <LoadingView/>;\n  }\n  return(\n    <Popup open={props.open} modal contentStyle={contentStyle2}>\n    <box className={styles.box}>\n      <CloseOutlinedIcon style={{ height: 40, width: 40 }} className={styles.cross} onClick={()=>props.setOpen(false)}/>\n      <h1 className={styles.header}>Log in</h1>\n      <p className={styles.para}>Whether you're a contractor, homeowner or homebuilder, log in here!</p>\n      <box className={styles.rectangle}>\n        <div>\n          <SignInGoogle signIn={onSignIn}/>\n        </div>\n        <button\n          className={styles.apple}\n          onClick={()=>\n            swal({\n              title: \"Feature Unavailable!\",\n              text: \"Please sign up with google or create an account!\",\n              icon: \"error\",\n              button: \"Go back!\",\n            })}>\n            <img src={alogo} className={styles.logo}alt={'apple'} />\n            <p ClassName={styles.signupapple} style={{marginTop:'20px'}}>Log in with Apple</p>\n        </button>\n        <div className={styles.linesdiv}>\n          <hr className={styles.line1}></hr>\n          <p className={styles.or}>OR</p>\n          <hr className={styles.line1}></hr>\n        </div>\n        <Login setLoading={setLoading} setOpen1={setOpen1}/>\n      </box>\n    </box>\n    <SignUpPage setOpen={setOpen1} open={open1}/>\n    </Popup>\n  );\n}\nclass SignInGoogleBase extends Component {\n  constructor(props) {\n    super(props);\n \n    this.state = { error: null };\n  }\n \n  onSubmit = event => {\n    this.props.firebase\n      .doSignInWithGoogle()\n      .then(socialAuthUser => {\n        // debugger;\n        // this.props.firebase\n        //   .user(socialAuthUser.user.uid)\n        //   .set({\n        //     username: socialAuthUser.user.displayName,\n        //     email: socialAuthUser.user.email,\n        //     roles: {},\n        //   });\n        // debugger;\n        this.props.signIn();\n      })\n      .then(() => {\n        this.setState({ error: null });\n        this.props.history.push(ROUTES.LANDING);\n      })\n      .catch(error => {\n        this.setState({ error });\n      });\n \n    event.preventDefault();\n  };\n \n  render() {\n    const { error } = this.state;\n \n    return (\n      <form onSubmit={this.onSubmit}>\n        <button\n          className={styles.apple}>\n            <img src={glogo} className={styles.logo} alt={'google'}/>\n              <p ClassName={styles.signupapple} style={{marginTop:'20px'}} >Log in with Google</p>\n        </button>\n \n        {error && <p>{error.message}</p>}\n      </form>\n    );\n  }\n}\nconst SignInGoogle = compose(\n  withRouter,\n  withFirebase,\n)(SignInGoogleBase);\n\nclass Login extends Component {\n\n  constructor() {\n    super();\n    this.state = {\n      error: null,\n      email: '',\n      password: '',\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.loginClicked = this.loginClicked.bind(this);\n  }\n\n  signInCallback(val){\n    // console.log(val);\n    if (val['usertype'] === 'Contractor'){\n      window.location.href='/contractorexplore'\n    }\n    else if (val['usertype'] === 'Client'){\n      window.location.href='/homeownerexplore'\n    }\n    else{\n      swal({\n        title: \"Login Error!\",\n        text: \"Incorrect username or password!\",\n        icon: \"error\",\n        button: \"Try Again\",\n      });\n    }\n  }\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n  loginClicked(event){\n    this.props.setLoading(true)\n    const callBack = this.signInCallback\n    if (this.state.email && this.state.password){\n      Firebase.auth.signInWithEmailAndPassword(this.state.email, this.state.password)\n      .then((userCredential) => {\n        userCredential.user.getIdToken(/* forceRefresh */ true).then(function(idToken) {\n          // Signed in\n          api.signIn({'id_token':idToken},callBack)\n            this.props.setLoading(false)\n        })\n        \n      })\n      .catch((error) => {\n        var errorCode = error.code;\n        var errorMessage = error.message;\n        //Still have to sign in with the django backend\n        const info = {\n          \"username\": this.state.email,\n          \"password\": this.state.password\n        }\n        api.signIn(info,this.signInCallback)\n        this.props.setLoading(false)\n        // ...\n      });\n      \n    }\n  }\n\n  async handleSubmit(event) {\n    event.preventDefault();\n    this.setState({ error: '' });\n    try {\n      await signin(this.state.email, this.state.password);\n    } catch (error) {\n      // this.setState({ error: error.message });\n    }\n  }\n  render() {\n    return (\n      <div className={styles.loginContainer}>\n        <form autoComplete=\"off\" onSubmit={this.handleSubmit}>         \n          <h3 className={styles.password}>Email</h3>\n          <div className={styles.rectangle1}>\n            <input className={styles.input1} placeholder=\"Enter your email address\" name=\"email\" type=\"email\" onChange={this.handleChange} value={this.state.email}></input>\n          </div>\n          <h3 className={styles.password}>Password</h3>\n          <div className={styles.rectangle1}>\n            <input className={styles.input1} placeholder=\"Password\" name=\"password\" onChange={this.handleChange} value={this.state.password} type=\"password\"></input>\n          </div>\n          <div className={styles.loginbuttondiv}>\n            {this.state.error ? <p className=\"text-danger\">{this.state.error}</p> : null}\n            <LoginButton type=\"submit\" className={styles.loginbutton} onClick={this.loginClicked}>\n              <p className={styles.login}>Log in </p>\n            </LoginButton>\n          </div>\n          <div className={styles.textdiv}>\n            <p className={styles.text2}>Don't have an account?</p> \n            <p className={styles.signup} onClick={()=>this.props.setOpen1(true)}> Sign up</p>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nconst LoginButton = withStyles((theme) => ({\n  root: {\n    color: theme.palette.getContrastText(purple[500]),\n    borderRadius:44,\n    backgroundColor: '#2B64D2',\n    '&:hover': {\n      backgroundColor: '#003ba0',\n    },\n  },\n}))(Button);\n\nexport default SignIn;"]},"metadata":{},"sourceType":"module"}